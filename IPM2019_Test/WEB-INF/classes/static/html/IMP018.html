<!DOCTYPE html>
<html>



<head>
    <meta charset="utf-8">
    <title>IPM - Fault Model</title>

    <!-- We use google fonts for many of the examples, but they are not necessary -->
    <link href='../styles/googleapis_Roboto.css' rel='stylesheet' type='text/css'>

    <!-- Test container style sheets -->
    <link rel="stylesheet" href="../styles/examples.css">

    <!-- Vizuly specific style sheets -->
    <link rel="stylesheet" href="../styles/vizuly.css">
    <link rel="stylesheet" href="../styles/vizuly_weightedtree.css">

    <!-- Supporting test container files:  Vizuly does NOT rely on these -->
    <link href="../styles/googleapis_materialicon.css" rel="stylesheet">
    <link rel="stylesheet" href="../styles/cssmenu.css">
    <script type="text/javascript" src="../JScript/jquery-2.1.1.min.js"></script>
    <script src="../JScript/cssmenu.js"></script>

    <!-- D3.js ... of course! -->
    <script src="../JScript/d3.min.js"></script>

    --> <!-- debug source scripts: end -->
	

    <script src="../JScript/vizuly_core.min.js"></script>
	<script src="../JScript/vizuly_weightedtree.min.js"></script>
<style>

@font-face {
	font-family: 'AccentureRotis';
	src: url('../styles/rotsan.woff') format('woff'); /* Modern Browsers */
	}
	
	body {
		font-family: AccentureRotis;
	 }
	 
</style>

</head>



<body onload = "onload()">

<div id='cssmenu'>
    <ul class="main-menu">
        <li class='active'>
            <a><span>Display</span><br><span class="setting"></span></a>
            <!--ul class="options"-->
                <li id="currentDisplay"></li>
                <!--li item_value="1000,1000"><a>1000px - 1000px</a></li-->
                <!--li item_value="800,600"><a>800px - 600px</a></li-->
                <!--li item_value="375,667"><a>375px - 667px</a></li-->
                <!--li item_value="320,568"><a>320px - 568px</a></li-->
            <!--/ul-->
			
        </li>
		
        <!-- <li class='active'><a><span>Theme </span><br><span class="setting"></span></a> -->
            <!-- <ul class="options" callback="changeSkin"> -->
                <!-- <li item_value="None"><a>None</a></li> -->
                <!-- <li item_value="Axiis" class="selected"><a>Axiis</a></li> -->
            <!-- </ul> -->
        <!-- </li> -->
        <!-- <li class='active'><a><span class="label">Data </span><br><span class="setting"></span></a> -->
          <!-- <ul class="options" callback="changeData"> -->
                <!-- <li item_value="0" class="selected"><a>Failures</a></li> -->
                <!-- <li item_value="1"><a>State</a></li> -->
                <!-- <li item_value="2"><a>Local</a></li> -->
            <!-- </ul> -->
        <!-- </li> -->
    </ul>
</div>

<!-- Our main content container-->
<!-- <div class="container" style="width:100%"> -->

 <div id="wrapper">
<div class="fixed-header">
	   <label style="font-family:AccentureRotis;fcolor:#e25c09;">Deviation Across </label><label style="font-family:AccentureRotis;">WorkStreams</label>
	   <!-- </div>    -->
	   
	   </div> </br></br>
	   </div>
	   
    <div id="viz_container">
	<br/>
	<input type="radio" style="margin-left: 8%;" id="wk_RCA" onclick="radio_RCA(this);" name="Deviation" value="0" checked /><i id="check_box1" >Deviation Across WorkStreams</i>
		<input type="radio" id="ly_RCA" onclick="radio_RCA(this);" name="Deviation" value="1"/><i id="check_box2" >Deviation Across Layers</i>
		<a href="javascript:viewfullpage();" id ="view_page" style="margin-left: 80px;">Zoomout view</a>
		<label id="ws_lbl" style="font-size: 16px; margin-left: 20px;">Response time: </label>		
		<input type="Number" id="res_txt" onfocusout="call_RCA()" style="width: 40px; margin-left: 5px;" min="0"/>
		<label id="sec_lbl" style="font-size: 12px; margin-left: 2px;">Seconds</label>		
		
		
	<a href="javascript:clickDownload();" id ="Download_Workstream" ><img src="../images/Download.png"  style="color:black; width: 48px; height: 30px; margin-top: 20px; margin-right: 30px; float: right;" ></a>
	<br/>
	</div>
    </div>
       
    <!-- </div> -->
	<div class="sticky">
<div class="fixed-footer"></div>
</div>
<script src="../JScript/Lapam.js"></script>
<script>


getObservation();	
localStorage.setItem("isDetailedView", "false");	
	function viewfullpage()
	{
		var win = window.open("RCA.html", '_blank');
		localStorage.setItem("isDetailedView", "true");
		win.focus();
	}
	
	function radio_RCA()
	{
		if(document.getElementById('ly_RCA').checked)
		{
			//parent.ifm_content.src = "RCA_Layers.html";
			window.location.href = "RCA_Layers.html";
		}
		else{
			//parent.ifm_content.src = "RCA.html";
			window.location.href = "RCA.html";
		}
	}

	function clickDownload(){
		window.open(filename, '_blank');
	}
	
	function onload() {	
		var xhttp = new XMLHttpRequest();
		var array = [];
		xhttp.onreadystatechange = function() {
			if (xhttp.readyState == 4 && xhttp.status == 200) {
				var res_value = xhttp.responseText.split(" = ")[1];
				document.getElementById("res_txt").value = res_value;
				localStorage.setItem("RCA_responseval", res_value);
				var fd = new FormData();
				fd.append("userid", localStorage.getItem("ipm_UserId"));
				fd.append("prjid", localStorage.getItem("rep_id"));
				fd.append("Txt_testname", localStorage.getItem("reportname") );
				fd.append("res_time", res_value);
				xhttp.onreadystatechange = function() {
					if (this.readyState == 4 && this.status == 200) {
					 }
				 };
				 xhttp.open("POST", "../cgi-bin/SAPRCA.py",true);
				 xhttp.send(fd);
			}
		}
		xhttp.open("GET", "IMP018.config", true);
		xhttp.send();
	}
	
	function call_RCA() {			
		var fd = new FormData();
		var xhttp = new XMLHttpRequest();
		fd.append("userid", localStorage.getItem("ipm_UserId"));
		fd.append("prjid", localStorage.getItem("rep_id"));
		fd.append("Txt_testname", localStorage.getItem("reportname") );
		localStorage.setItem("RCA_responseval", document.getElementById("res_txt").value);
		fd.append("res_time", document.getElementById("res_txt").value);
		xhttp.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				window.location.href = "RCA.html";
			 }
		 };
		 xhttp.open("POST", "../cgi-bin/SAPRCA.py",true);
		 xhttp.send(fd);
	}
	
	function getQueryStrings() {
		  var StrVal  = {};
		  var decode = function (s) { return decodeURIComponent(s.replace(/\+/g, " ")); };
		  var queryString = location.search.substring(1); 
		  var keyValues = queryString.split('&'); 

		  for(var i in keyValues) { 
			var key = keyValues[i].split('=');
			if (key.length > 1) {
			  StrVal[decode(key[0])] = decode(key[1]);
			}
		  } 
		  return StrVal; 
	} 

	var qs = getQueryStrings();
	var qs_size = Object.keys(qs).length;
	if(qs_size > 1)
	{
		localStorage.setItem("testname",qs["testname"]);
	}
		
    //Once the document is ready we set javascript and page settings
    var screenWidth;
    var screenHeight;
	//var testname = localStorage.getItem("testname").toLowerCase();
	var log_folder = localStorage.getItem("ipm_UserId") +"_"+localStorage.getItem("rep_id")+"_"+localStorage.getItem("reportname").toLowerCase();
	var testname = localStorage.getItem("testname");
	var userid = localStorage.getItem("UserId");
	var prjid = localStorage.getItem("PrjId");
	test_log = userid + "_"+prjid+"_"+testname;
	var filename = "Reports\\"+log_folder+"\\RCAWorkStream_"+localStorage.getItem("RCA_responseval")+".csv"; 

    $(document).ready(function () {

        var rect;
        if (self==top) {
            rect = document.body.getBoundingClientRect();
        }
        else {
            rect =  parent.document.body.getBoundingClientRect();
        }

        //Set display size based on window size.
        screenWidth = (rect.width < 960) ? Math.round(rect.width*.95) : Math.round((rect.width - 210) *.95);

        screenHeight=750;

        d3.select("#currentDisplay")
                .attr("item_value", (String(screenWidth) + "," + String(screenHeight)))
                .attr("class", "selected")
                .html("<a>" + screenWidth + "px - " + screenHeight + "px</a>");


        $("#cssmenu").menumaker({
            title: "FAULT MODEL",
            format: "multitoggle"
			//text-align: "center";
        });

        // Set the size of our container element.
        viz_container = d3.selectAll("#viz_container")
                .style("width", screenWidth + "px")
                .style("height", screenHeight + "px");
				
        loadData();

    });

</script>
<script src="../JScript/RCA.js"></script>
</body>
</html>
