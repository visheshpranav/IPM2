<html>
<head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">		
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<!--link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"-->
<link rel="stylesheet" href="../styles/font-awesome/css/font-awesome.min.css">
<script src="../JScript/d3.v2.js"></script>
<script src="../JScript/d3-time-format.v2.min.js"></script>
<script src="../JScript/jquery.min.js" type="text/javascript">
</script>
</head>
<style>


@font-face {
	font-family: 'AccentureRotis';
	src: url('../styles/rotsan.woff') format('woff'); /* Modern Browsers */
	}
	
	body {
		font-family: AccentureRotis;
	 }


h1{	margin-bottom: 0; }
		
p{margin-top: 0;}
		
#Rollview {
    font-family: "AccentureRotis";
    border-collapse: collapse;
    width: 90%;
	margin-left:20px;
	font-size: 12px;
}

#Rollview td, #Rollview th {
    border: 1px solid #ddd;
    padding: 8px;
}

#Rollview tr:nth-child(even){background-color: #f2f2f2;}

#Rollview tr:hover {background-color: #ddd;}

#Rollview th {
    padding-top: 12px;
    padding-bottom: 12px;
    text-align: left;
    background-color: #5d8aa8;
    color: white;
}
</style>

<body>
<label id="StatusMode_lbl" style="float: left; margin-left: 10px; width: 100%; margin-bottom: 0px;"></label>
<button onclick="goBack()" style="font-family:AccentureRotis;float: right;">Back</button>
<div class="fixed-header">
       <!-- <div class="container"> -->
	    <h1 id="Lbl_hdr" style="color:black; font-size:14px; font-weight:bold; font-family: AccentureRotis, sans-serif; margin-left: 20%;
    margin-bottom: 0px;">Failure Analysis</h1>
</br></br>

	<div id="Rollview" class="component"></div>
<script>
sessionStorage.setItem("isDrilldown", "true");

function goBack(){
	window.location.href = "IMP006.html";
}
 function getParamValuesByName (queryString1) {
	var qstring = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
 // console.log(qstring.length);
    for (var i = 0; i < qstring.length; i++) {
  
    var urlparam = qstring[i].split('=');
    if (urlparam[0] == queryString1) {

       return urlparam[1];
    }
  }
}

// function to remove above 20 chars from service call	
function trimname(name5){
	var day= decodeURI(name5).split("_");
	var name6;
	var len=day[1].length-4
	var strname;
	if(len>20){
	strname=day[1].substr(0,20);

	}
	else{
	strname=day[1].substring(0, day[1].length - 4);
	}
	name6=day[0]+"_"+strname;
	return name6;
		  
}  
var name1 = getParamValuesByName('name');
var name3=	trimname(name1);
//var log_folder = localStorage.getItem("ipm_UserId") + "_" + localStorage.getItem("rep_id");
//var file_name = localStorage.getItem("ipm_appname") + "_" + localStorage.getItem("reportname").toLowerCase() + "_" + sessionStorage.getItem("Imperative_name");
var csv_filename = "";
var current_date= new Date().getFullYear()+'-'+("0"+(new Date().getMonth()+1)).slice(-2)+'-'+("0"+new Date().getDate()).slice(-2);
if(sessionStorage.getItem("isOnline") =="true")
{
	document.getElementById("StatusMode_lbl").innerHTML = "<i class=\"fa fa-circle\" style=\"color: green;\"></i> ";
	document.getElementById("StatusMode_lbl").style.color = "green";
	var filename = "";	
	file_name = localStorage.getItem("ipm_appname") + "_" + sessionStorage.getItem("Imperative_name");
	if(localStorage.getItem("online_tp") == "false"){
		csv_filename = "online/"+file_name+"_ONL_"+name1+"_"+current_date+".csv";
	}
	else{
		csv_filename = "online/"+file_name+"_TP_"+name1+"_"+current_date+".csv";
	}
}
else{
	document.getElementById("StatusMode_lbl").innerHTML = "<i class=\"fa fa-circle\" style=\"color: #7194b2;\"></i> ";
	document.getElementById("StatusMode_lbl").style.color = "#7194b2";
	var log_folder = localStorage.getItem("ipm_UserId") + "_" + localStorage.getItem("rep_id");
	var file_name = localStorage.getItem("ipm_appname") + "_" + localStorage.getItem("reportname").toLowerCase() + "_" + sessionStorage.getItem("Imperative_name");
	var filename = "Reports/"+log_folder+"/"+file_name+"_fail_response.txt";
	csv_filename = "Reports/"+log_folder+"/"+file_name+"_"+name1+".csv";
}

 $.get(csv_filename, function(data) 
 {
	Lbl_hdr.innerText = "Failure Analysis - " + name1.split("_")[1];
	var build = '<table>\n';
	var rows = data.split("\n");
	var isRole = false;
	var i = true;
	ser_no = 1;
	rows.forEach( function getvalues(thisRow) 
	{
		var columns = thisRow.split(",");
		if (columns[0] == "Datetime"){
			build +=" <thead> <tr>" ;
			build += "<th>S.no</th>"
			for(var i=0;i<columns.length;i++){
				build += "<th>" + columns[i] + "</th>\n"; 
			}		
			build +="</tr></thead>\n <tbody> ";
			i = false;
		}
		else{
			if(ser_no != rows.length-1)
			{
				build += "<tr><td>" + ser_no +"</td>"
				for(var i=0;i<columns.length;i++){
					build += "<td>" + columns[i] + "</td>"; 
				}
				build += "</tr>\n";
				ser_no++;
			}
		
		}
	})
	build += "</tbody></table>";
	$('#Rollview').append(build);	
 });
 
</script>
<script src="../JScript/jquery.min.js"></script>
<script src="../JScript/jquery.ba-throttle-debounce.min.js"></script>

</body>
</html>