<!DOCTYPE html>
<html>
<script language="JavaScript" type="text/javascript" src="../JScript/json2.js"></script>
<script language="JavaScript" type="text/javascript" src="../JScript/jquery-1.8.3.js"></script>
<link href="../styles/bootstrap.min.css" rel="stylesheet">

<style>

@font-face {
		font-family: 'AccentureRotis';
		src: url('../styles/rotsan.woff') format('woff'); /* Modern Browsers */
	}
	
body {
font-family: AccentureRotis;
}
	

label {
  padding: 12px 12px 12px 0;
  display: inline-block;
  font-family: AccentureRotis;
}

html, body { font-family: 'AccentureRotis'; }

table { border-collapse: collapse; }

tbody tr:first-child { pointer-events: none; font-weight:bold} 
table tr td {
  border: 1px solid #000;
  padding: 10px;
}

table tr:nth-child(odd) { background: #f4f4f4; }

tr:hover {
background-color:#ffff99!important;
cursor:pointer;
}

td{
word-break: break-all;
font-size:14px;
}

table{
table-layout:fixed;
width:75%;
float:right;
}
	@font-face {
		font-family: 'AccentureRotis';
		src: url('../styles/rotsan.woff') format('woff'); /* Modern Browsers */
	}
	
body {
font-family: AccentureRotis;
}
	
.fieldset-checkbox {
    border-radius: 25px;
    height: auto;
    width: 900px;
    border: solid;
	margin-left:16%;
}
fieldset {
    display: block;
	margin-inline-start: 2px;
    margin-inline-end: 2px;
    padding-block-start: 0.35em;
    padding-inline-start: 0.75em;
    padding-inline-end: 0.75em;
    padding-block-end: 0.625em;
    min-inline-size: min-content;
    border-width: 2px;
    border-style: groove;
    border-color: threedface;
    border-image: initial;
}
label {
 
  font-family: AccentureRotis;
  font-size:12px;
  font-weight:bold;
}

html, body { font-family: 'AccentureRotis'; }
.loader {
    position: fixed;
    left: 0px;
    top: 0px;
    width: 100%;
    height: 100%;
    z-index: 9999;
    background: url('../images/loader.gif') 50% 50% no-repeat rgb(249,249,249);
	opacity: .8;
	}

</style>
<body>
<div class="loader" style="display:none"></div>
<div id="Div_NewQual" class="NewQual" style="background-image: url('../images/upload.png'), linear-gradient(#ffffff,#d9d9d9); background-position: center right; background-size: contain; background-repeat: no-repeat; margin-top: 10%; background-blend-mode: normal;font-family: AccentureRotis,Arial,sans-serif;">
<fieldset id="fs_atr" class="fieldset-checkbox">
<div id="container" style="margin-top:20px;margin-bottom:10px;float:right;" ></div>
<div style="position:fixed;float:left;">
  <label style="margin-left:5%" class="list-heading1" id="CompareTest_lbl1">Select reports and template to compare</label></br>
  <div style="width: 100%;float:left">
   <label style="margin-left:5%" for="Pattern">Choose Datatype:</label>

<select name="typepat" id="typepat" style="margin-left:20%" onchange="fetchReports1(),fetchReports2(),fetchtemplate()">
  <option disabled selected value> -- select an option -- </option>
  <option value="TradeInsertion">TradeInsertion</option>
  <option value="DeliverableMXML">DeliverableMXML</option>
 </select>
 <br>
 <label style="margin-left:5%" for="Pattern">Choose template:</label>

<select id="slt_view4" style="margin-left:20%"; ></select>
 <br>
 
 <label for="Repname" id="LRepname" style="margin-left:5%" >Comparison Report name:</label>
  <input type="text" id="Repname" name="pname" style="margin-left:12%" ><br>
  <br>
 <label style="margin-left:5%" for="Pattern">Choose Basereport:</label>

<select id="slt_view" style="margin-left:18%"; ></select>
 <br>
 
 
 <label style="margin-left:5%; " for="Pattern">Choose Comparereport:</label>
<select id="slt_view2" style="margin-left:14%"; ></select>

<button type="submit" value="Upload" id="Btn_upload22" class="btn btn-primary"  onclick="getvaluesd()" style="width: 100px; margin-left: 140px; font-family: AccentureRotis;">Compare</button>

<br><br><br><br>
<!-- <button type="submit" value="Upload" id="Btn_upload24" class="btn btn-primary"  onclick="javascript:clickDownload();" style="width: 100px; margin-left: 140px; font-family: AccentureRotis; display:none">Download</button>
 -->

</div>
</div>
</body>
</div>
</fieldset>





<script>


function fetchReports1()
{

$("#slt_view").empty();
	var xhttp = new XMLHttpRequest();
	var fd = new FormData();
		
	fd.append("user_name",localStorage.getItem("ipm_username"));
	fd.append("logtype",document.getElementById("typepat").value);
	xhttp.open("POST", "../cgi-bin/gettemplates.py",true);
	xhttp.onreadystatechange = function() {
	if (this.readyState == 4 && this.status == 200)
			{
			allText = this.responseText;
			var optionValues1 = allText.split("\n");
			var value = "";
			optionValues = optionValues1.filter(function(item) {
			return item !== value
			})
			optionValues.shift();
			for (var i=0;i<optionValues.length;i++){
            jQuery('#slt_view').append(jQuery("<option></option>").val(optionValues[i]).text(optionValues[i]))
			}
			jQuery('#slt_view').append(jQuery("<option disabled selected value> -- select an option -- </option>"))
			SortOptions("#slt_view");
			}			
			};
	xhttp.send(fd);
		
}		
	
function fetchReports2()
{

$("#slt_view2").empty();
	var xhttp = new XMLHttpRequest();
	var fd = new FormData();
		
	fd.append("user_name",localStorage.getItem("ipm_username"));
	fd.append("logtype",document.getElementById("typepat").value);
	xhttp.open("POST", "../cgi-bin/gettemplates.py",true);
	xhttp.onreadystatechange = function() {
	if (this.readyState == 4 && this.status == 200)
			{
			allText = this.responseText;
			var optionValues1 = allText.split("\n");
			var value = "";
			optionValues = optionValues1.filter(function(item) {
			return item !== value
			})
			optionValues.shift();
			for (var i=0;i<optionValues.length;i++){
            jQuery('#slt_view2').append(jQuery("<option></option>").val(optionValues[i]).text(optionValues[i]))
			}
			jQuery('#slt_view2').append(jQuery("<option disabled selected value> -- select an option -- </option>"))
			SortOptions("#slt_view2");
			}			
			};
	xhttp.send(fd);
		
}		

function fetchtemplate()
{

$("#slt_view4").empty();
	var xhttp = new XMLHttpRequest();
	var fd = new FormData();
		
	fd.append("logtype",document.getElementById("typepat").value);
	xhttp.open("POST", "../cgi-bin/gettemplate.py",true);
	xhttp.onreadystatechange = function() {
	if (this.readyState == 4 && this.status == 200)
			{
			allText = this.responseText;
			var optionValues1 = allText.split("\n");
			var value = "";
			optionValues = optionValues1.filter(function(item) {
			return item !== value
			})
			optionValues.shift();
			for (var i=0;i<optionValues.length;i++){
            jQuery('#slt_view4').append(jQuery("<option></option>").val(optionValues[i]).text(optionValues[i]))
			}
			jQuery('#slt_view4').append(jQuery("<option disabled selected value> -- select an option -- </option>"))
			}			
			};
	xhttp.send(fd);
		
}		
	
function SortOptions(id) {
    var prePrepend = "#";
    if (id.match("^#") == "#") prePrepend = "";
    $(prePrepend + id).html($(prePrepend + id + " option").sort(
        function (a, b) { return a.text == b.text ? 0 : a.text < b.text ? -1 : 1 })
    );
}
	
function showLoader()
	{
    $(".loader").fadeIn("slow");	
	}
function hideLoader()
	{
    $(".loader").fadeOut("slow");
	}
	
function getvaluesd()
{
var f = document.getElementById("Repname").value.trim();
var t = document.getElementById("slt_view").value.trim();
var r = document.getElementById("slt_view2").value.trim();
var y = document.getElementById("slt_view4").value.trim();
var k = document.getElementById("typepat").value.trim();

if(t == "" ||r == "" ||k == ""||f == "")
{
alert("Kindly choose all values from dropdown and fill report name then compare");
return false;

} 
 /*if(y == "No Data")
{
alert("You cant proceed for deliverables now, as no data available");
return false;

} */
if(y == "" && k == "DeliverableMXML")
{
alert("You cant proceed for deliverables now, as no data available");
return false;

} 


if(t==r)
{
alert("Reports cant be same! select two different reports");
return false;
}
else
{
var btn = document.getElementById('Btn_upload22');
btn.disabled = true;
//alert("You can proceed");
showLoader();
localStorage.setItem("comareRN",f);
localStorage.setItem("Baserp",t);
localStorage.setItem("Comprerp",r);
localStorage.setItem("Templatenm",y);
var txtFile = new XMLHttpRequest();		
var fd = new FormData();
fd.append("user_id",localStorage.getItem("ipm_UserId"));
fd.append("log_type",k);
fd.append("template_name",y);
fd.append("base_report",t);
fd.append("compare_report",r);
fd.append("comparison_reportname",f);
txtFile.open("POST", "../cgi-bin/compare_reports.py",true);
txtFile.onreadystatechange = function() {
	if (this.readyState == 4 && this.status == 200)
		{
		allText = this.responseText;
		
		if(allText)
		{
		alert(allText);
		hideLoader();
		return false;
		}
		else
		{
		//alert("Report created you can dowload here");
		//document.getElementById("Btn_upload24").style.display = "block";
		myfunction1();
		hideLoader();
		}
		}			
	};
	txtFile.send(fd);
}
}

  function clickDownload(){
   	var foldername= localStorage.getItem("comareRN");
	var filename = "Reports/44_Compare/"+foldername+"/compare.csv";
	window.open(filename, '_blank');
	}
	
	
function myfunction1()
{
var txtFile = new XMLHttpRequest();		
var fd = new FormData();
fd.append("username","murex");
fd.append("user_id",localStorage.getItem("ipm_UserId"));
fd.append("Txt_reportname",localStorage.getItem("comareRN"));
fd.append("BaseRP",localStorage.getItem("Baserp"));
fd.append("CompRP",localStorage.getItem("Comprerp"));
fd.append("TempNM",localStorage.getItem("Templatenm"));
txtFile.open("POST", "../cgi-bin/comparedb.py",true);
txtFile.onreadystatechange = function() {
	if (this.readyState == 4 && this.status == 200)
			{
			allText = this.responseText;
			alert(allText);
			}			
		};
		txtFile.send(fd);

}
	
</script>
</html>